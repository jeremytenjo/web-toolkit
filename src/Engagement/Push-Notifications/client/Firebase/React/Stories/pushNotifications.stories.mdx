import { Meta, Story, Preview } from '@storybook/addon-docs/blocks'
import Example from './example'

<Meta title='Engagement|Push Notifications/Firebase/React' />

## Usage

Add provider to Store
```js
import { NotificationsProvider } from '@tenjojeremy/web-toolkit/build/Engagement/Push-Notifications/client/Firebase/React/useNotifications.index'
 ```

use in comoponent
```js
import useNotifications from '@tenjojeremy/web-toolkit/build/Engagement/Push-Notifications/client/Firebase/React/useNotifications.index'
 ```

 ```js
const { init, token, isSupported } = useNotifications()
 ```

<Preview>
<Story name='Example'>
   <>
    <Example />    
  </>
</Story>
</Preview>

### with Firebase 

1. Add to `manifest.json`  `gcm_sender_id`. Insert the value below AS IT IS, without changing anything.

```json
{
	"gcm_sender_id": "103953800507"
}
```

2. Create `firebase-messaging-sw.js` file. This handles background notitifactons when app not in use

3. add firebase-messaging-sw registration to window in order to show notitifactions

```js 
<script type="text/javascript">
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/firebase-messaging-sw.js')
    .then(function(registration) {
      window.firebaseMessagingSWRegistration = registration
    })
    .catch(function(error) {
      console.log('Service worker registration failed, error:', error);
    });
  }
  </script>
```


4. `useNotifications.js` handles messages when app is open
